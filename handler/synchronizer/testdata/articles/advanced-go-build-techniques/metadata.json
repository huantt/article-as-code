{"url":"https://dev.to/jacktt/go-build-in-advance-4o8n","slug":"advanced-go-build-techniques","title":"Advanced Go Build Techniques","description":"Table of contents   Build options Which file will be included Build tags Build contraints           ...","body_markdown":"Table of contents\n- [Build options](#i-build-options)\n- [Which file will be included](#ii-which-file-will-be-included)\n- [Build tags](#iii-build-tags)\n- [Build contraints](#iv-build-contraints)\n\n## I/ Build options\n\nThe following are some of the most commonly used options for the `go build` command:\n\n* `-o`: Specifies the output file name. The default output file name is the name of the main package, with the `.exe` suffix added on Windows.\n* `-v`: Verbose output. This option prints the names of the packages as they are being compiled.\n* `-work`: Prints the name of the temporary work directory and does not delete it when exiting. This option is useful for debugging.\n* `-x`: Print the commands. This option prints the commands that are being executed by the `go build` command.\n* `-asmflags`: Arguments to pass to the `go tool asm` invocation.\n* `-buildmode`: The build mode to use. The default build mode is `exe`. Other possible values are `shared`, `pie`, and `plugin`.\n* `-buildvcs`: Whether to stamp binaries with version control information. The default value is `auto`.\n\nFor more information about the `go build` command, you can run the following command:\n```bash\ngo help build\n```\n\n## II/ Which file will be included\nWhen you use the `go build` command in Go, it compiles the Go source files in the current directory and its subdirectories to create an executable binary. By default, Go only compiles `.go` files and ignores other types of files in the directory. However, it's important to note that the behavior of the `go build` command can be influenced by build tags, build constraints.\n\nThe following types of files are typically ignored by `go build`:\n\n**1. Files with Non-`.go` Extensions:** \n\nAny files in the directory that don't have a `.go` extension will be ignored. This includes text files, configuration files, images, etc.\n\n**2. Files in Subdirectories:** \n\nThe `go build` command compiles all `.go` files in the current directory and its subdirectories. Other files and directories will generally be ignored.\n\n**3. Files with Underscores OR Periods in the Beginning:** \n\nDirectory and file names that begin with `\".\"` or `\"_\"` are ignored by the go tool, as are directories named \"testdata\".\n\n**4. Files Excluded by Build Constraints:** \n\nGo supports build constraints which allow you to include or exclude specific files from the build based on conditions like the target operating system or architecture. For example, files with build constraints like `//go:build windows` will be ignored when building for non-Windows platforms.\n\n**5. Files Excluded by Build Tags:** \n\nBuild tags are special comments in Go source files that can be used to specify which files should be included in the build based on custom conditions. Files with build tags that don't match the build context will be ignored.\n\n**6. Files in Directories Named \"testdata\":** Files in directories named `testdata` are ignored by design. This directory is commonly used to include test-related data that's not meant to be compiled.\n\n## III/ Build tags\nGo's build tags provide a powerful mechanism for including or excluding specific code during the build process. By using build tags, developers can tailor their application to work with different build configurations, environments, or platform-specific requirements. This feature is particularly valuable when dealing with cross-compilation or creating binaries for specific operating systems.\n\nA build tag is a comment placed at the beginning of a Go source file that specifies a set of conditions under which the code within that file should be included or excluded from the build. The syntax is //go:build \u003ctag\u003e. For instance, consider a scenario where you want to include a specific piece of code only when building for a certain version of the application:\n\n`main.go`\n\n```go\npackage main\n\nimport \"fmt\"\n\nvar version string\n\nfunc main() {\n\tfmt.Println(version)\n}\n```\n\n`pro.go`\n```go\n//go:build pro\n\npackage main\n\nfunc init() {\n\tversion = \"pro\"\n}\n```\n\n`free.go`\n```go\n//go:build free\n\npackage main\n\nfunc init() {\n\tversion = \"pro\"\n}\n\n```\n\nWhen you build with `-tags=free`, the output will be `free` because the `free.go` file was included. And when you build with `-tags=pro`, the output will be `pro`.\n\n### Build Tags Syntax\n\nYou can combine constraints in the same way as you would any other conditional statement in programming i.e AND, OR, NOT\n\n**NOT**\n\n```go\n//go:build !cgo\n```\n\nThis will only include the file in the build if CGO is NOT enabled.\n\n**AND**\n\n```go\n//go:build cgo \u0026\u0026 darwin\n```\nThis will only include the file in the build if CGO is enabled and the GOOS is set to darwin.\n\n**OR**\n```go\n//go:build darwin || linux\n```\n\n**Combine them all e.g**\n\n```go\n//go:build (linux || 386) \u0026\u0026 (darwin || !cgo)\n```\nResults to (linux AND 386) OR (darwin AND (NOT cgo)).\n\n\n**Note:**\nGo versions `1.16` and earlier used a different syntax for build constraints, with a `// +build` prefix. The gofmt command will add an equivalent `//go:build` constraint when encountering the older syntax.\n\n## IV/ Build contraints\nWhile custom build tags are set using the tags build flag, golang automatically sets a few tags based on environment variables and other factors. Here is a list of the available tags\n\n**1. OOS and GOARCH Environment Values**\nYou can set constraints in your source code to only run files if a certain GOOS or GOARCH is used. e.g\n\n```go\n//go:build darwin,amd64\n\npackage utils\n```\n\n**2. GO Version constraint**\n\nYou can also constrain the inclusion of a file to the go version being used in building the entire module. EX to only build the file if the go version being used is 1.12 and above you would use `//go:build go1.18`. This would include the file if the go version is 1.18 or 1.21 (latest as of writing this).\n\n## References\n- https://kofo.dev/build-tags-in-golang\n- https://pkg.go.dev/cmd/go\n- https://www.digitalocean.com/community/tutorials/customizing-go-binaries-with-build-tags","body_html":"\u003cp\u003eTable of contents\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#i-build-options\"\u003eBuild options\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ii-which-file-will-be-included\"\u003eWhich file will be included\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#iii-build-tags\"\u003eBuild tags\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#iv-build-contraints\"\u003eBuild contraints\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n  \u003ca name=\"i-build-options\" href=\"#i-build-options\"\u003e\n  \u003c/a\u003e\n  I/ Build options\n\u003c/h2\u003e\n\n\u003cp\u003eThe following are some of the most commonly used options for the \u003ccode\u003ego build\u003c/code\u003e command:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e-o\u003c/code\u003e: Specifies the output file name. The default output file name is the name of the main package, with the \u003ccode\u003e.exe\u003c/code\u003e suffix added on Windows.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-v\u003c/code\u003e: Verbose output. This option prints the names of the packages as they are being compiled.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-work\u003c/code\u003e: Prints the name of the temporary work directory and does not delete it when exiting. This option is useful for debugging.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-x\u003c/code\u003e: Print the commands. This option prints the commands that are being executed by the \u003ccode\u003ego build\u003c/code\u003e command.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-asmflags\u003c/code\u003e: Arguments to pass to the \u003ccode\u003ego tool asm\u003c/code\u003e invocation.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-buildmode\u003c/code\u003e: The build mode to use. The default build mode is \u003ccode\u003eexe\u003c/code\u003e. Other possible values are \u003ccode\u003eshared\u003c/code\u003e, \u003ccode\u003epie\u003c/code\u003e, and \u003ccode\u003eplugin\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-buildvcs\u003c/code\u003e: Whether to stamp binaries with version control information. The default value is \u003ccode\u003eauto\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFor more information about the \u003ccode\u003ego build\u003c/code\u003e command, you can run the following command:\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ego \u003cspan class=\"nb\"\u003ehelp \u003c/span\u003ebuild\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003ch2\u003e\n  \u003ca name=\"ii-which-file-will-be-included\" href=\"#ii-which-file-will-be-included\"\u003e\n  \u003c/a\u003e\n  II/ Which file will be included\n\u003c/h2\u003e\n\n\u003cp\u003eWhen you use the \u003ccode\u003ego build\u003c/code\u003e command in Go, it compiles the Go source files in the current directory and its subdirectories to create an executable binary. By default, Go only compiles \u003ccode\u003e.go\u003c/code\u003e files and ignores other types of files in the directory. However, it's important to note that the behavior of the \u003ccode\u003ego build\u003c/code\u003e command can be influenced by build tags, build constraints.\u003c/p\u003e\n\n\u003cp\u003eThe following types of files are typically ignored by \u003ccode\u003ego build\u003c/code\u003e:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e1. Files with Non-\u003ccode\u003e.go\u003c/code\u003e Extensions:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eAny files in the directory that don't have a \u003ccode\u003e.go\u003c/code\u003e extension will be ignored. This includes text files, configuration files, images, etc.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e2. Files in Subdirectories:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003ego build\u003c/code\u003e command compiles all \u003ccode\u003e.go\u003c/code\u003e files in the current directory and its subdirectories. Other files and directories will generally be ignored.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e3. Files with Underscores OR Periods in the Beginning:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eDirectory and file names that begin with \u003ccode\u003e\".\"\u003c/code\u003e or \u003ccode\u003e\"_\"\u003c/code\u003e are ignored by the go tool, as are directories named \"testdata\".\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e4. Files Excluded by Build Constraints:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eGo supports build constraints which allow you to include or exclude specific files from the build based on conditions like the target operating system or architecture. For example, files with build constraints like \u003ccode\u003e//go:build windows\u003c/code\u003e will be ignored when building for non-Windows platforms.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e5. Files Excluded by Build Tags:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eBuild tags are special comments in Go source files that can be used to specify which files should be included in the build based on custom conditions. Files with build tags that don't match the build context will be ignored.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e6. Files in Directories Named \"testdata\":\u003c/strong\u003e Files in directories named \u003ccode\u003etestdata\u003c/code\u003e are ignored by design. This directory is commonly used to include test-related data that's not meant to be compiled.\u003c/p\u003e\n\n\u003ch2\u003e\n  \u003ca name=\"iii-build-tags\" href=\"#iii-build-tags\"\u003e\n  \u003c/a\u003e\n  III/ Build tags\n\u003c/h2\u003e\n\n\u003cp\u003eGo's build tags provide a powerful mechanism for including or excluding specific code during the build process. By using build tags, developers can tailor their application to work with different build configurations, environments, or platform-specific requirements. This feature is particularly valuable when dealing with cross-compilation or creating binaries for specific operating systems.\u003c/p\u003e\n\n\u003cp\u003eA build tag is a comment placed at the beginning of a Go source file that specifies a set of conditions under which the code within that file should be included or excluded from the build. The syntax is //go:build . For instance, consider a scenario where you want to include a specific piece of code only when building for a certain version of the application:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emain.go\u003c/code\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"s\"\u003e\"fmt\"\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eversion\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003e\u003ccode\u003epro.go\u003c/code\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build pro\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"n\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eversion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"pro\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003e\u003ccode\u003efree.go\u003c/code\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build free\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"n\"\u003emain\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"n\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eversion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\"pro\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003eWhen you build with \u003ccode\u003e-tags=free\u003c/code\u003e, the output will be \u003ccode\u003efree\u003c/code\u003e because the \u003ccode\u003efree.go\u003c/code\u003e file was included. And when you build with \u003ccode\u003e-tags=pro\u003c/code\u003e, the output will be \u003ccode\u003epro\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch3\u003e\n  \u003ca name=\"build-tags-syntax\" href=\"#build-tags-syntax\"\u003e\n  \u003c/a\u003e\n  Build Tags Syntax\n\u003c/h3\u003e\n\n\u003cp\u003eYou can combine constraints in the same way as you would any other conditional statement in programming i.e AND, OR, NOT\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNOT\u003c/strong\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build !cgo\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003eThis will only include the file in the build if CGO is NOT enabled.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAND\u003c/strong\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build cgo \u0026amp;\u0026amp; darwin\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003eThis will only include the file in the build if CGO is enabled and the GOOS is set to darwin.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eOR\u003c/strong\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build darwin || linux\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003e\u003cstrong\u003eCombine them all e.g\u003c/strong\u003e\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build (linux || 386) \u0026amp;\u0026amp; (darwin || !cgo)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003eResults to (linux AND 386) OR (darwin AND (NOT cgo)).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e\u003cbr\u003e\nGo versions \u003ccode\u003e1.16\u003c/code\u003e and earlier used a different syntax for build constraints, with a \u003ccode\u003e// +build\u003c/code\u003e prefix. The gofmt command will add an equivalent \u003ccode\u003e//go:build\u003c/code\u003e constraint when encountering the older syntax.\u003c/p\u003e\n\u003ch2\u003e\n  \u003ca name=\"iv-build-contraints\" href=\"#iv-build-contraints\"\u003e\n  \u003c/a\u003e\n  IV/ Build contraints\n\u003c/h2\u003e\n\n\u003cp\u003eWhile custom build tags are set using the tags build flag, golang automatically sets a few tags based on environment variables and other factors. Here is a list of the available tags\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e1. OOS and GOARCH Environment Values\u003c/strong\u003e\u003cbr\u003e\nYou can set constraints in your source code to only run files if a certain GOOS or GOARCH is used. e.g\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e//go:build darwin,amd64\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003epackage\u003c/span\u003e \u003cspan class=\"n\"\u003eutils\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cp\u003e\u003cstrong\u003e2. GO Version constraint\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eYou can also constrain the inclusion of a file to the go version being used in building the entire module. EX to only build the file if the go version being used is 1.12 and above you would use \u003ccode\u003e//go:build go1.18\u003c/code\u003e. This would include the file if the go version is 1.18 or 1.21 (latest as of writing this).\u003c/p\u003e\n\n\u003ch2\u003e\n  \u003ca name=\"references\" href=\"#references\"\u003e\n  \u003c/a\u003e\n  References\n\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://kofo.dev/build-tags-in-golang\"\u003ehttps://kofo.dev/build-tags-in-golang\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pkg.go.dev/cmd/go\"\u003ehttps://pkg.go.dev/cmd/go\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.digitalocean.com/community/tutorials/customizing-go-binaries-with-build-tags\"\u003ehttps://www.digitalocean.com/community/tutorials/customizing-go-binaries-with-build-tags\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n","thumbnail":"https://res.cloudinary.com/practicaldev/image/fetch/s--dwEQQuvx--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/w3qkrh0jj4qkeumkm880.png","author":{"id":"jacktt","name":"Jack"},"created_at":"2023-08-30T06:25:09Z","updated_at":null,"tags":[]}